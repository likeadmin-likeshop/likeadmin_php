import{d as a,A as e,o as s,c as t,w as l,h as r,g as c,b as o,l as h,e as u,f as n,t as i,F as d,k as p,m as _,z as f,V as m,al as g,aM as x,aN as y,aO as v,aA as w,r as b,a as k}from"./index.ca94a073.js";import{_ as j}from"./u-search.cd975ef0.js";import{_ as C}from"./news-card.2df3b746.js";import{_ as V}from"./z-paging.aed00d7c.js";import{_ as z}from"./plugin-vue_export-helper.21dcd24c.js";import{b as I}from"./shop.464c26c1.js";import{g as A}from"./news.2fa1a523.js";import"./u-icon.aab9c090.js";import"./u-image.35d0c847.js";import"./icon_visit.9ad00ab7.js";var S=z(a({__name:"suggest",props:{hot_search:{default:()=>({data:[],status:0})},his_search:{default:()=>[]}},emits:["search","clear"],setup(a,{emit:_}){const f=a,m=e((()=>f.hot_search.data.filter((a=>a.name)))),g=a=>{_("search",a)};return(e,f)=>{const x=p;return s(),t(x,{class:"suggest bg-white"},{default:l((()=>[r(" 热门搜索 "),1==a.hot_search.status&&c(m).length?(s(),t(x,{key:0,class:"hot"},{default:l((()=>[o(x,{class:"font-medium pl-[24rpx] pt-[26rpx] pb-[6rpx] text-lg"},{default:l((()=>[h("热门搜索")])),_:1}),o(x,{class:"w-full px-[24rpx]"},{default:l((()=>[(s(!0),u(d,null,n(c(m),((a,e)=>(s(),t(x,{key:e,class:"keyword truncate max-w-full",onClick:e=>g(a.name)},{default:l((()=>[h(i(a.name),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):r("v-if",!0),1==a.hot_search.status&&c(m).length&&a.his_search.length?(s(),t(x,{key:1,class:"mx-[24rpx] my-[40rpx] border-b border-solid border-0 border-light"})):r("v-if",!0),r(" 历史搜索 "),a.his_search.length?(s(),t(x,{key:2,class:"history"},{default:l((()=>[o(x,{class:"flex justify-between px-[24rpx] pb-[6rpx] pt-[26rpx]"},{default:l((()=>[o(x,{class:"text-lg font-medium"},{default:l((()=>[h("历史搜索")])),_:1}),o(x,{class:"text-xs text-muted",onClick:f[0]||(f[0]=()=>_("clear"))},{default:l((()=>[h("清空")])),_:1})])),_:1}),o(x,{class:"w-full px-[24rpx]"},{default:l((()=>[(s(!0),u(d,null,n(a.his_search,((a,e)=>(s(),t(x,{key:e,class:"keyword truncate",onClick:e=>g(a)},{default:l((()=>[h(i(a),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):r("v-if",!0)])),_:1})}}}),[["__scopeId","data-v-6ff22e4e"]]);var U=z(a({__name:"search",setup(a){const e=_({hot_search:{data:[],status:1},his_search:[],result:[],searching:!1}),c=f(""),h=m(),i=a=>{c.value=a,c.value&&(e.his_search.includes(c.value)||(e.his_search.unshift(c.value),g.set(x,e.his_search))),h.value.reload(),e.searching=!0},z=async()=>{(await w({title:"温馨提示",content:"是否清空历史记录？"})).confirm&&(g.set(x,""),e.his_search=[])},U=async(a,e)=>{try{const{lists:s}=await A({keyword:c.value,page_no:a,page_size:e});h.value.complete(s)}catch(s){console.log("报错=>",s),h.value.complete(!1)}};return(async()=>{try{e.hot_search=await I()}catch(a){console.log("获取热门搜索失败=>",a)}})(),e.his_search=g.get(x)||[],(a,_)=>{const f=b(k("u-search"),j),m=p,g=b(k("news-card"),C),x=b(k("z-paging"),V);return s(),t(m,{class:"search"},{default:l((()=>[r(" 搜索框 "),o(m,{class:"px-[24rpx] py-[14rpx] bg-white"},{default:l((()=>[o(f,{modelValue:c.value,"onUpdate:modelValue":_[0]||(_[0]=a=>c.value=a),placeholder:"请输入关键词搜索",height:"72",onSearch:i,onCustom:i,onClear:_[1]||(_[1]=a=>e.searching=!1)},null,8,["modelValue"])])),_:1}),r(" 搜索 "),o(m,{class:"search-content"},{default:l((()=>[r("  "),y(o(S,{onSearch:i,onClear:z,hot_search:e.hot_search,his_search:e.his_search},null,8,["hot_search","his_search"]),[[v,!e.searching]]),r("  "),y(o(m,{class:"search-content-s pt-[20rpx]"},{default:l((()=>[o(x,{ref_key:"paging",ref:h,modelValue:e.result,"onUpdate:modelValue":_[2]||(_[2]=a=>e.result=a),onQuery:U,fixed:!1,height:"100%"},{default:l((()=>[(s(!0),u(d,null,n(e.result,(a=>(s(),t(g,{key:a.id,item:a,newsId:a.id},null,8,["item","newsId"])))),128))])),_:1},8,["modelValue"])])),_:1},512),[[v,e.searching]])])),_:1})])),_:1})}}}),[["__scopeId","data-v-5fd54b17"]]);export{U as default};
