import{X as J,C as W,w as Q,E as Y,a as ee,O as ue,P as le,Z as te,$ as oe,D as se,v as ae,F as ne}from"./element-plus.81dd3128.js";import{o as de,p as ie,b as re,r as U,q as pe,M as m,s as ce,t as me}from"./index.539edab6.js";import{d as P,r as T,s as R,a1 as z,e as G,w as Fe,j as _e,o as r,c as h,W as l,O as t,u as c,M as E,X as L,a as o,a9 as S,R as fe,V as Ee,$ as q,U as v,n as I,T as b}from"./@vue.af680e04.js";import{c as ve}from"./@vueuse.8c34eaea.js";import{P as Ce}from"./index.4e68035a.js";const be={class:"icon-select"},Ve={class:"flex justify-between"},Be=o("div",{class:"mb-3"},"\u8BF7\u9009\u62E9\u56FE\u6807",-1),he=["onClick"],De={class:"h-[280px]"},ye={class:"flex flex-wrap"},Ae={key:0,class:"flex items-center"},ke=v("\u65E0"),ge=P({__name:"picker",props:{modelValue:{default:""},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(p,{emit:D}){const y=T(0),k=[{name:"element\u56FE\u6807",icons:de()},{name:"\u672C\u5730\u56FE\u6807",icons:ie()}],V=R(),s=z({inputValue:"",popoverVisible:!1,popoverWidth:0,mouseoverSelect:!1,inputFocus:!1}),N=()=>{s.inputFocus=s.popoverVisible=!0},w=()=>{s.inputFocus=!1,s.popoverVisible=s.mouseoverSelect},$=F=>{s.mouseoverSelect=s.popoverVisible=!1,D("update:modelValue",F),D("change",F)},u=()=>{D("update:modelValue",""),D("change","")},M=G(()=>{var f,B;const F=(B=(f=k[y.value])==null?void 0:f.icons)!=null?B:[];if(!s.inputValue)return F;const n=s.inputValue.toLowerCase();return F.filter(A=>{if(A.toLowerCase().indexOf(n)!==-1)return A})}),x=()=>{I(()=>{var n;const F=(n=V.value)==null?void 0:n.$el.offsetWidth;s.popoverWidth=F<300?300:F})};return ve(document.body,"click",()=>{s.popoverVisible=!!(s.inputFocus||s.mouseoverSelect)}),Fe(()=>s.popoverVisible,async F=>{var n,f;await I(),F?(n=V.value)==null||n.focus():(f=V.value)==null||f.blur()}),_e(()=>{x()}),(F,n)=>{const f=re,B=Q,A=Y,O=ee,d=J;return r(),h("div",be,[l(d,{trigger:"contextmenu",visible:s.popoverVisible,"onUpdate:visible":n[3]||(n[3]=e=>s.popoverVisible=e),width:s.popoverWidth},{reference:t(()=>[l(c(W),{ref_key:"inputRef",ref:V,modelValue:s.inputValue,"onUpdate:modelValue":n[2]||(n[2]=e=>s.inputValue=e),modelModifiers:{trim:!0},placeholder:"\u641C\u7D22\u56FE\u6807",autofocus:!1,disabled:p.disabled,onFocus:N,onBlur:w,clearable:""},{prepend:t(()=>[p.modelValue?(r(),h("div",Ae,[l(O,{class:"flex-1 w-20",content:p.modelValue,placement:"top"},{default:t(()=>[(r(),E(f,{class:"mr-1",key:p.modelValue,name:p.modelValue,size:16},null,8,["name"]))]),_:1},8,["content"])])):(r(),h(L,{key:1},[ke],64))]),append:t(()=>[l(B,null,{default:t(()=>[l(f,{name:"el-icon-Close",size:18,onClick:u})]),_:1})]),_:1},8,["modelValue","disabled"])]),default:t(()=>[o("div",{onMouseover:n[0]||(n[0]=q(e=>s.mouseoverSelect=!0,["stop"])),onMouseout:n[1]||(n[1]=q(e=>s.mouseoverSelect=!1,["stop"]))},[o("div",null,[o("div",Ve,[Be,o("div",null,[(r(),h(L,null,S(k,(e,i)=>o("span",{key:i,class:fe(["cursor-pointer text-sm ml-2",{"text-primary":i==y.value}]),onClick:C=>y.value=i},Ee(e.name),11,he)),64))])]),o("div",De,[l(A,null,{default:t(()=>[o("div",ye,[(r(!0),h(L,null,S(c(M),e=>(r(),h("div",{key:e,class:"m-1"},[l(B,{onClick:i=>$(e)},{default:t(()=>[l(f,{name:e,size:18},null,8,["name"])]),_:2},1032,["onClick"])]))),128))])]),_:1})])])],32)]),_:1},8,["visible","width"])])}}});function Ue(p){return U.get({url:"/auth.menu/lists",params:p})}function we(p){return U.post({url:"/auth.menu/add",params:p})}function xe(p){return U.post({url:"/auth.menu/edit",params:p})}function du(p){return U.post({url:"/auth.menu/delete",params:p})}function Te(p){return U.get({url:"/auth.menu/detail",params:p})}const Ne={class:"edit-popup"},$e=v("\u76EE\u5F55"),Me=v("\u83DC\u5355"),Oe=v("\u6309\u94AE"),Le={class:"flex-1"},Re=o("div",{class:"form-tips"}," \u8BBF\u95EE\u7684\u8DEF\u7531\u5730\u5740\uFF0C\u5982\uFF1A`user`\uFF0C\u5982\u5916\u7F51\u5730\u5740\u9700\u5185\u94FE\u8BBF\u95EE\u5219\u4EE5`http(s)://`\u5F00\u5934 ",-1),Se={class:"flex-1"},qe=o("div",{class:"form-tips"}," \u8BBF\u95EE\u7684\u7EC4\u4EF6\u8DEF\u5F84\uFF0C\u5982\uFF1A`user/setting`\uFF0C\u9ED8\u8BA4\u5728`views`\u76EE\u5F55\u4E0B ",-1),Ie={class:"flex-1"},We=o("div",{class:"form-tips"}," \u8BBF\u95EE\u8BE6\u60C5\u9875\u9762\uFF0C\u7F16\u8F91\u9875\u9762\u65F6\uFF0C\u83DC\u5355\u9AD8\u4EAE\u663E\u793A\uFF0C\u5982`/consumer/lists` ",-1),Pe={class:"flex-1"},ze=o("div",{class:"form-tips"}," \u5C06\u4F5C\u4E3Aserver\u7AEFAPI\u9A8C\u6743\u4F7F\u7528\uFF0C\u5982`auth.admin/user`\uFF0C\u8BF7\u8C28\u614E\u4FEE\u6539 ",-1),Ge={class:"flex-1"},je=o("div",{class:"form-tips"},' \u8BBF\u95EE\u8DEF\u7531\u7684\u9ED8\u8BA4\u4F20\u9012\u53C2\u6570\uFF0C\u5982\uFF1A`{"id": 1, "name": "admin"}`\u6216`id=1&name=admin` ',-1),Xe=v("\u7F13\u5B58"),Ke=v("\u4E0D\u7F13\u5B58"),Ze=o("div",{class:"form-tips"},"\u9009\u62E9\u7F13\u5B58\u5219\u4F1A\u88AB`keep-alive`\u7F13\u5B58",-1),He=v("\u663E\u793A"),Je=v("\u9690\u85CF"),Qe=o("div",{class:"form-tips"}," \u9009\u62E9\u9690\u85CF\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4F46\u4ECD\u7136\u53EF\u4EE5\u8BBF\u95EE ",-1),Ye=v("\u6B63\u5E38"),eu=v("\u505C\u7528"),uu=o("div",{class:"form-tips"},"\u9009\u62E9\u505C\u7528\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4E5F\u4E0D\u80FD\u88AB\u8BBF\u95EE",-1),lu=o("div",{class:"form-tips"},"\u6570\u503C\u8D8A\u5927\u8D8A\u6392\u524D",-1),iu=P({__name:"edit",emits:["success","close"],setup(p,{expose:D,emit:y}){const k=R(),V=R(),s=T("add"),N=G(()=>s.value=="edit"?"\u7F16\u8F91\u83DC\u5355":"\u65B0\u589E\u83DC\u5355"),w=T(pe()),$=(d,e)=>{const i=d?w.value.filter(C=>C.toLowerCase().includes(d.toLowerCase())):w.value;e(i.map(C=>({value:C})))},u=z({id:"",pid:0,type:m.CATALOGUE,icon:"",name:"",sort:0,paths:"",perms:"",component:"",selected:"",params:"",is_cache:0,is_show:1,is_disable:0}),M={pid:[{required:!0,message:"\u8BF7\u9009\u62E9\u7236\u7EA7\u83DC\u5355",trigger:["blur","change"]}],name:[{required:!0,message:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",trigger:"blur"}],paths:[{required:!0,message:"\u8BF7\u8F93\u5165\u8DEF\u7531\u5730\u5740",trigger:"blur"}],component:[{required:!0,message:"\u8BF7\u8F93\u5165\u7EC4\u4EF6\u5730\u5740",trigger:"blur"}]},x=T([]),F=async()=>{const d=await Ue({page_type:0}),e={id:0,name:"\u9876\u7EA7",children:[]};e.children=ce(me(d.lists).filter(i=>i.type!=m.BUTTON)),x.value.push(e)},n=async()=>{var d,e;await((d=k.value)==null?void 0:d.validate()),s.value=="edit"?await xe(u):await we(u),(e=V.value)==null||e.close(),y("success")},f=(d="add")=>{var e;s.value=d,(e=V.value)==null||e.open()},B=d=>{for(const e in u)d[e]!=null&&d[e]!=null&&(u[e]=d[e])},A=async d=>{const e=await Te({id:d.id});B(e)},O=()=>{y("close")};return F(),D({open:f,setFormData:B,getDetail:A}),(d,e)=>{const i=ue,C=le,_=se,j=te,g=W,X=ge,K=oe,Z=ae,H=ne;return r(),h("div",Ne,[l(Ce,{ref_key:"popupRef",ref:V,title:c(N),async:!0,width:"550px",onConfirm:n,onClose:O},{default:t(()=>[l(H,{ref_key:"formRef",ref:k,model:u,"label-width":"80px",rules:M},{default:t(()=>[l(_,{label:"\u83DC\u5355\u7C7B\u578B",prop:"type",required:""},{default:t(()=>[l(C,{modelValue:u.type,"onUpdate:modelValue":e[0]||(e[0]=a=>u.type=a)},{default:t(()=>[l(i,{label:c(m).CATALOGUE},{default:t(()=>[$e]),_:1},8,["label"]),l(i,{label:c(m).MENU},{default:t(()=>[Me]),_:1},8,["label"]),l(i,{label:c(m).BUTTON},{default:t(()=>[Oe]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1}),l(_,{label:"\u7236\u7EA7\u83DC\u5355",prop:"pid"},{default:t(()=>[l(j,{class:"flex-1",modelValue:u.pid,"onUpdate:modelValue":e[1]||(e[1]=a=>u.pid=a),data:x.value,clearable:"","node-key":"id",props:{label:"name"},"default-expand-all":!0,placeholder:"\u8BF7\u9009\u62E9\u7236\u7EA7\u83DC\u5355","check-strictly":""},null,8,["modelValue","data"])]),_:1}),l(_,{label:"\u83DC\u5355\u540D\u79F0",prop:"name"},{default:t(()=>[l(g,{modelValue:u.name,"onUpdate:modelValue":e[2]||(e[2]=a=>u.name=a),placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",clearable:""},null,8,["modelValue"])]),_:1}),u.type!=c(m).BUTTON?(r(),E(_,{key:0,label:"\u83DC\u5355\u56FE\u6807",prop:"icon"},{default:t(()=>[l(X,{class:"flex-1",modelValue:u.icon,"onUpdate:modelValue":e[3]||(e[3]=a=>u.icon=a)},null,8,["modelValue"])]),_:1})):b("",!0),u.type!=c(m).BUTTON?(r(),E(_,{key:1,label:"\u8DEF\u7531\u8DEF\u5F84",prop:"paths"},{default:t(()=>[o("div",Le,[l(g,{modelValue:u.paths,"onUpdate:modelValue":e[4]||(e[4]=a=>u.paths=a),placeholder:"\u8BF7\u8F93\u5165\u8DEF\u7531\u8DEF\u5F84",clearable:""},null,8,["modelValue"]),Re])]),_:1})):b("",!0),u.type==c(m).MENU?(r(),E(_,{key:2,label:"\u7EC4\u4EF6\u8DEF\u5F84",prop:"component"},{default:t(()=>[o("div",Se,[l(K,{class:"w-full",modelValue:u.component,"onUpdate:modelValue":e[5]||(e[5]=a=>u.component=a),"fetch-suggestions":$,clearable:"",placeholder:"\u8BF7\u8F93\u5165\u7EC4\u4EF6\u8DEF\u5F84"},null,8,["modelValue"]),qe])]),_:1})):b("",!0),u.type==c(m).MENU?(r(),E(_,{key:3,label:"\u9009\u4E2D\u83DC\u5355",prop:"selected"},{default:t(()=>[o("div",Ie,[l(g,{modelValue:u.selected,"onUpdate:modelValue":e[6]||(e[6]=a=>u.selected=a),placeholder:"\u8BF7\u8F93\u5165\u8DEF\u7531\u8DEF\u5F84",clearable:""},null,8,["modelValue"]),We])]),_:1})):b("",!0),u.type!=c(m).CATALOGUE?(r(),E(_,{key:4,label:"\u6743\u9650\u5B57\u7B26",prop:"perms"},{default:t(()=>[o("div",Pe,[l(g,{modelValue:u.perms,"onUpdate:modelValue":e[7]||(e[7]=a=>u.perms=a),placeholder:"\u8BF7\u8F93\u5165\u6743\u9650\u5B57\u7B26",clearable:""},null,8,["modelValue"]),ze])]),_:1})):b("",!0),u.type==c(m).MENU?(r(),E(_,{key:5,label:"\u8DEF\u7531\u53C2\u6570",prop:"params"},{default:t(()=>[o("div",null,[o("div",Ge,[l(g,{modelValue:u.params,"onUpdate:modelValue":e[8]||(e[8]=a=>u.params=a),placeholder:"\u8BF7\u8F93\u5165\u8DEF\u7531\u53C2\u6570",clearable:""},null,8,["modelValue"])]),je])]),_:1})):b("",!0),u.type==c(m).MENU?(r(),E(_,{key:6,label:"\u662F\u5426\u7F13\u5B58",prop:"is_cache",required:""},{default:t(()=>[o("div",null,[l(C,{modelValue:u.is_cache,"onUpdate:modelValue":e[9]||(e[9]=a=>u.is_cache=a)},{default:t(()=>[l(i,{label:1},{default:t(()=>[Xe]),_:1}),l(i,{label:0},{default:t(()=>[Ke]),_:1})]),_:1},8,["modelValue"]),Ze])]),_:1})):b("",!0),u.type!=c(m).BUTTON?(r(),E(_,{key:7,label:"\u662F\u5426\u663E\u793A",prop:"is_show",required:""},{default:t(()=>[o("div",null,[l(C,{modelValue:u.is_show,"onUpdate:modelValue":e[10]||(e[10]=a=>u.is_show=a)},{default:t(()=>[l(i,{label:1},{default:t(()=>[He]),_:1}),l(i,{label:0},{default:t(()=>[Je]),_:1})]),_:1},8,["modelValue"]),Qe])]),_:1})):b("",!0),u.type!=c(m).BUTTON?(r(),E(_,{key:8,label:"\u83DC\u5355\u72B6\u6001",prop:"is_disable",required:""},{default:t(()=>[o("div",null,[l(C,{modelValue:u.is_disable,"onUpdate:modelValue":e[11]||(e[11]=a=>u.is_disable=a)},{default:t(()=>[l(i,{label:0},{default:t(()=>[Ye]),_:1}),l(i,{label:1},{default:t(()=>[eu]),_:1})]),_:1},8,["modelValue"]),uu])]),_:1})):b("",!0),l(_,{label:"\u83DC\u5355\u6392\u5E8F",prop:"sort"},{default:t(()=>[o("div",null,[l(Z,{modelValue:u.sort,"onUpdate:modelValue":e[12]||(e[12]=a=>u.sort=a),min:0},null,8,["modelValue"]),lu])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])])}}});export{iu as _,Ue as a,du as m};
